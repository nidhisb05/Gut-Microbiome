---
title             : "Supplementation of Probiotics on Academic Examination Performance and Stress in Healthy Medical Students"
shorttitle        : "Probiotics Effect on Academic Performance and Stress in Medical Students"

author: 
  - name          : "Nidhi Sheshachala"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Postal address"
    email         : "my@email.com"
    role: # Contributorship roles (e.g., CRediT, https://credit.niso.org/)
      - "Conceptualization"
      - "Writing - Original Draft Preparation"
      - "Writing - Review & Editing"
  - name          : "Ernst-August Doelle"
    affiliation   : "1,2"
    role:
      - "Writing - Review & Editing"
      - "Supervision"

affiliation:
  - id            : "1"
    institution   : "Wilhelm-Wundt-University"
  - id            : "2"
    institution   : "Konstanz Business School"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  One or two sentences providing a **basic introduction** to the field,  comprehensible to a scientist in any discipline.
  Two to three sentences of **more detailed background**, comprehensible  to scientists in related disciplines.
  One sentence clearly stating the **general problem** being addressed by  this particular study.
  One sentence summarizing the main result (with the words "**here we show**" or their equivalent).
  Two or three sentences explaining what the **main result** reveals in direct comparison to what was thought to be the case previously, or how the  main result adds to previous knowledge.
  One or two sentences to put the results into a more **general context**.
  Two or three sentences to provide a **broader perspective**, readily comprehensible to a scientist in any discipline.
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "keywords"
wordcount         : "X"

bibliography      : "r-references.bib"

floatsintext      : no
linenumbers       : yes
draft             : no
mask              : no

figurelist        : no
tablelist         : no
footnotelist      : no

classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
source("A2-Package loading and assigning variables.R",local=knitr::knit_global())
```

```{r helloworld,include=TRUE}
source("HelloWorld Function.R", local=knitr::knit_global())
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

```{r read probioticsdata}

# Load packages
library(tidyverse)
library(readxl)

# Dataset Read-in
read_excel("Probiotics-Academic-Stress.xlsx")

# Naming Dataset
probiotics_data <- read_excel("Probiotics-Academic-Stress.xlsx")

# Data is tidy
# Each column is a single variable
# Each row is a single observation
# Each cell is a single measurement
# Need to remove individuals who dropped out of the dataset
# Required variables: Participant code, Group enrolment, Drop-out, Sex, Age, STAI trait, Pharmacology examination (points, set, pre-examination test), Anxiety at rest and under stress, Salivary cortisol at rest and under stress, Pulse rate at rest and under stress, salivary 5-HT at rest and under stress.
# Extraneous variables: Group follow-up and completed, Faculty, Nationality, BMI, EAT-26, BDI, and PSS-10
```

``` {r final-dataset}
# Dataset read-in - install and load required packages (tidyverse and readxl)
library(tidyverse)
library(readxl)
read_excel("Probiotics-Academic-Stress.xlsx")

# Name the dataset
probiotics.dataset <- read_excel("Probiotics-Academic-Stress.xlsx")

# Use dplyr functions to further select, filter and arrange dataset
# Display only the variables required
probiotics.stress.data <- probiotics.dataset |>
  filter(`Drop-out`== 0) |>
  mutate(`Group (enrolment)`= recode(`Group (enrolment)`, "P" = "Placebo", "S" = "Saccharomyces Boulardii (Probiotic)")) |>
  select(`Participant code`, `Group (enrolment)`, Sex, `Age [years]`, `PSS-10`, `STAI trait`, `Pharmacology examination points`, `Pharmacology examination set`, `Pharmacology pre-examination test`, `State anxiety "at rest"`, `State anxiety "under stress"`, `Salivary cortisol "at rest" [ng/ml]`, `Salivary cortisol "under stress" [ng/ml]`, `Pulse rate "at rest" [min-1]`, `Pulse rate "under stress" [min-1]`) |>
  rename("Perceived Stress Scale" = "PSS-10", "State-Trait Anxiety Inventory" = "STAI trait", "Age" = "Age [years]") |>
  arrange(`Group (enrolment)`, `Participant code`)

# Check the data types for each column
column_types <- sapply(probiotics.stress.data, class)
print(column_types)
```

``` {r plot1-examscores}
# Plot 1 will display the pre-examination and examination scores for participants in both groups
# X Axis = Placebo or Probiotic, Y Axis = Score
# Displayed as either a box/distribution plot OR a bar chart
# Bar chart will not show individual variation - box/distribution plot may work better
# Comparing pre-examination and examination for the two treatment groups
# Hypothesis - Pre-examination scores for both groups will be similar, treatment with probiotic could result in better examination scores compared to the placebo group

library(tidyverse)
# Creates plot1 long data
plot1_data <- gather(probiotics.stress.data, key = "Exam_score_type", value = "Score", `Exam score`, `Pre-examination score`)

# Selecting the variables required for plot1
plot1_columns <- plot1_data %>%
  select(`Participant code`, `Group`, `Exam_score_type`, `Score`)

# Re-order the exams so that pre-examination score is on the left side of the plot, and exam score is on the right side
exam_order <- c("Pre-examination score", "Exam score")

# Making a boxplot displaying the pre-examination and exam scores for the two different groups (placebo or probiotic)
ggplot(data = plot1_columns) + 
  geom_boxplot(aes(x = `Group`, y = `Score`, 
                   fill = reorder(Exam_score_type, match(Exam_score_type, exam_order)))) + 
  geom_jitter(aes(x = `Group`, y = `Score`,
                  color = reorder(Exam_score_type, match(Exam_score_type, exam_order))), # Make sure jitter data points are associated with their respective groups
              width = 0.1) + # Included jitter points to show each individual's exam score
  labs(fill = "Exam Type",
       color = "Exam Type") 
```

``` {r plot2-cortisol-and-pulserate}
# Plot 2 will display the salivary cortisol levels vs. pulse rates - continuous variable against a continuous variable
# X Axis = Salivary Cortisol levels, Y Axis = Pulse Rates
# Displayed as a scatter plot with a smooth or dashed line to show the correlation
# Will need to compare groups (use different symbols, colors, and lines) - at-rest and under-stress levels for both treatment groups (placebo or probiotic)
# Hypothesis - Salivary cortisol levels will increase with an increase in pulse rate, treatment with probiotic could result in a lower salivary cortisol rate and have an effect on stress
library(tidyverse)

plot2_longdata <- probiotics.stress.data %>%
  gather(key = "At Rest or Under Stress", value = "Cortisol",
         `Salivary cortisol "at rest" [ng/ml]`, `Salivary cortisol "under stress" [ng/ml]`) %>%
  gather(key = "At Rest or Under Stress", value = "Pulse Rate",
         `Pulse rate "at rest" [min-1]`, `Pulse rate "under stress" [min-1]`)

plot2_columns <- plot2_longdata %>%
  select('Participant code', 'Group', 'Cortisol', 'At Rest or Under Stress', 'Pulse Rate') %>%
  mutate(`At Rest or Under Stress` = gsub("Pulse rate \"at rest\" \\[min-1\\]", "At rest", `At Rest or Under Stress`)) %>%
  mutate(`At Rest or Under Stress` = gsub("Pulse rate \"under stress\" \\[min-1\\]", "Under stress", `At Rest or Under Stress`)) %>%
  mutate('Group' = replace(`Group`, `Group` == "Saccharomyces Boulardii (Probiotic)", "Probiotic"))

plot2_columns %>%
  filter(!(Cortisol > 10)) %>%
  ggplot(aes(x = `Cortisol`, y = `Pulse Rate`, shape = `Group`, color = `At Rest or Under Stress`)) +
  geom_point() +
  coord_cartesian(xlim = c(0, 10), ylim = c(40, 140)) +
  geom_smooth(
    aes(group = ifelse(`At Rest or Under Stress` == "At Rest", 1, 2)),
    method = "lm",
    se = FALSE) +
  labs(title = "Cortisol vs Pulse Rate at rest and under stress",
      subtitle = "by Placebo and Probiotic groups",
      x = "Cortisol [ng/mL]",
      y = "Pulse Rate [min-1]") +
  theme_minimal() +
  theme(panel.background = element_rect(fill = "white"))
```

``` {r mockup-plot1and2}
# Mock-up plots sketched by hand
# Need figure out which style of plot to use and make sure all the axes have proper descriptions/measures
knitr::include_graphics("Probiotics-Stress-Plots.jpg")
```
# Introduction

## Hypothesis

### Definitions

# Methods
We report how we determined our sample size, all data exclusions (if any), all manipulations, and all measures in the study. <!-- 21-word solution (Simmons, Nelson & Simonsohn, 2012; retrieved from http://ssrn.com/abstract=2160588) -->

## Participants
**Healthy Medical Students**

## Material
Probiotic used is _Saccharomyces Boulardii_

<!-- Example of HTML-style comment -->

[Visit RCT Study](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7284642/)

## Procedure
### Unordered List:
- Measurement 1
- Measurement 2
- Measurement 3

Measuring the salivary cortisol levels ~~in the body~~

### Ordered List:
1. Step 1
2. Step 2
3. Step 3

## Data analysis
We used `r cite_r("r-references.bib")` for all our analyses.


# Results

# Discussion

\newpage

# References

::: {#refs custom-style="Bibliography"}
:::
