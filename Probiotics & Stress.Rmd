---
title             : "Supplementation with Yeast Probiotic, *Saccharomyces Boulardii*, and its Effects on Academic Examination Performance and Stress Markers in Healthy Medical Students"
shorttitle        : "Effects of *S. boulardii* Probiotic on Academic Performance and Stress Levels in Medical Students"

author: 
  - name          : "Nidhi Sheshachala"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    email         : "nidhisb@uchicago.edu"
affiliation:
  - id            : "1"
    institution   : "The University of Chicago"

authornote: |
  The University of Chicago MAPS30550.
  
abstract: |
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "keywords"
wordcount         : "X"

bibliography      : "r-references.bib"

floatsintext      : yes
linenumbers       : no
draft             : no
mask              : no

figurelist        : no
tablelist         : no
footnotelist      : no

classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
r_refs("r-references.bib")

options(repos = c(CRAN = "https://cran.rstudio.com/"))

library(Require)
library(tidyverse)
library(readxl)
library(knitr)
library(kableExtra)
library(lme4)
library(psych)
library(stats)
library(scales)
library(usethis)
Require("ggh4x")
library(devtools)
library(broom)
devtools::install_github("crsh/citr")
```

# Introduction
Memory processes are affected by an individual’s experiences, and stress has both positive and negative impacts on memory functioning [@Sandi-memoryimpair, ch. 12]. Buchanan et al., [-@Buchanan-impairedmemory] highglighted that each individual has a unique response and coping mechanism to stressful events, contributing to different effects of stress on memory. Medical students face stressful challenges from the start to the end of their medical journey, and this can impair cognitive ability [@Kar-examstress; @Dyrbye-medstudents]. These students undergo high-stake examinations contributing to performance anxiety [@Dyrbye-medstudents] and increased feelings of stress as the examination day occurs [@Kato-probioticbenefits]. While these stressors can impact academic performance, they may have detrimental effects on cognitive functioning, physiological, and psychological well-being of students. Therefore, it is necessary to identify a variety of effective techniques for stress management whether its mechanism works through improving one’s physical health, emotional functioning, or internally through the gut microbiota [@Worthen-stressmanage]. 

The gut-brain-axis (GBA) highlights the presence of bidirectional communication between the enteric nervous system (ENS) and the central nervous system (CNS) [@Kim-improvedprobioticeffects; @Harvard-probiotics]. With the gut having the ability to modulate brain functioning, targeting the gut microbiome to improve cognition and alleviate stress through probiotic supplementation has been investigated in recent years. Probiotics are strains of live microorganisms that can have beneficial effects on the gut microbiota and are “generally recognized as safe” by the Food and Drug Administration [@Kato-probioticbenefits; @Liu-probioticsdef, p.14; @CCEC-probioticbenefits; @Wauters-probioticbacteria]. Bacterial probiotics are more widely utilized and commonly investigated under research conditions. Probiotic bacterial strains - *Bifidobacterium longum* and *Lactobacillus casei* strain Shirota - have demonstrated health-promoting effects associated with cognitive impairment, academic performance, stress, anxiety and depression [@Kim-improvedprobioticeffects; @Kato-probioticbenefits; @Papalini-stressmatters] in animal and human studies. 

The unique properties of probiotics, which vary depending on the species, strain, and variant, make it challenging to apply findings from bacterial probiotics to yeast probiotics [@Goplan-probioticproperties; @Pais-probioticinfo]. One such yeast probiotic, *Saccharomyces boulardii*, is commonly used to treat gastrointestinal (GI) disorders [@Roysarkar-yeastprobioticeffect; @Pais-probioticinfo]. However, its potential effects on cognitive function and stress remain uncertain. *S. boulardii* belongs to the same genus as *Saccharomyces cerevisiae*, known as baker’s yeast [@Pais-probioticinfo]. Despite their close relation, *S. boulardii* possesses distinct biological characteristics that make it more advantageous for human health compared to *S. cerevisiae* [@Pais-probioticinfo]. For instance, *S. boulardii* thrives at 37°C and exhibits greater resistance to high temperatures, *S. cerevisiae* has an optimal growth temperature of 30°C, which is lower than human host temperatures [@Pais-probioticinfo]. Probiotics pass through the GI tract and must survive the adverse conditions posed by gastric juices and bile salts. While bacterial probiotics - *Lactobacillus* and *Bifidobacterium* species - have exhibited decreased viability with exposure to pepsin, hydrochloric acid, and bile salts in the GI tract [@Pais-probioticinfo], *S. boulardii* demonstrated the ability to survive the harsh GI conditions. Furthermore, as a yeast-origin probiotic, *S. boulardii* does not pose the risk of genetic transfer, a concern associated with bacterial probiotics [@Goplan-probioticproperties]. Understanding the potential cognitive and stress-related benefits of  *S. boulardii* beyond its GI applications is crucial. To delve into this, the present paper aims to analyze the data from a study conducted by @Karbownik-datasetstudy, examining the effects of *S. boulardii* supplementation on academic performance and stress markers in healthy medical students.

``` {r dataset-readin}
# Dataset Prep and read-in - load and name the dataset
probiotics.dataset <- read_excel("Probiotics-Academic-Stress.xlsx")
colnames(probiotics.dataset) <- tolower(colnames(probiotics.dataset)) # Change all column names to lowercase
```

```{r final-dataset}
# Use dplyr functions to further select, filter and arrange dataset
# Display only the variables required
probiotics.stress.data <- probiotics.dataset %>% 
  filter(`drop-out`== 0) %>%
  rename(
    "group" = "group (enrolment)",
    "age" = "age [years]",
    "final exam score" = "pharmacology examination points",
    "exam set" = "pharmacology examination set",
    "pre-exam score" = "pharmacology pre-examination test",
    "anxiety at rest" = "state anxiety \"at rest\"",
    "anxiety under stress" = "state anxiety \"under stress\"",
    "cortisol at rest" = "salivary cortisol \"at rest\" [ng/ml]",
    "cortisol under stress" = "salivary cortisol \"under stress\" [ng/ml]",
    "pulse rate at rest" = "pulse rate \"at rest\" [min-1]",
    "pulse rate under stress" = "pulse rate \"under stress\" [min-1]") %>% 
  mutate(`group`= recode(`group`, "P" = "Placebo", "S" = "S. boulardii (probiotic)")) %>% 
  filter(`cortisol under stress` < 80 ) %>%
  select(`participant code`, `group`, sex, `age`, `pss-10`, `stai trait`, `final exam score`, `exam set`, `pre-exam score`, `anxiety at rest`, `anxiety under stress`, `cortisol at rest`, `cortisol under stress`, `pulse rate at rest`, `pulse rate under stress`) %>% 
  arrange(`group`, `participant code`)

```

# Methods
The randomized, double-blind, and placebo-controlled study conducted by @Karbownik-datasetstudy examined the effects of the yeast probiotic *S. boulardii* on academic performance and stress marker levels. Third-year healthy medical students (ages 18-30) in the Faculty of Medicine or Faculty of Military Medicine at the Medical University of Lodz in Poland were recruited as participants for the study. All participation was voluntary.

Participants were randomly assigned the *S. boulardii* (probiotic) or placebo group. The study included `r nrow(filter(probiotics.stress.data, group == "Placebo"))` participants in the Placebo group, and `r nrow(filter(probiotics.stress.data, group == "S. boulardii (probiotic)"))` participants in the *S. boulardii* (Probiotic) group. Probiotic administration utilized LacidEnter capsules, which contained lyophilized *S. boulardii* CNCM I-1079, while the placebo capsule contained a maltodextrin mixture (“sugar pill”). Participants in both groups were instructed to consume one capsule daily in the morning for 30 days.

During the study, the model of stress was established in the form of an academic pharmacology exam. The primary outcome evaluated academic performance on the pharmacology final exam, and the secondary outcomes examined the psychology, physiology, and biochemical stress markers. The primary focus measured the number of correctly answered multiple-choice questions in a standard medical pharmacology exam, with a comparison made against a pre-exam assessment completed by participants a day before the final exam. Secondary measures included stress indicators like state anxiety, salivary cortisol levels, and pulse rate. These stress markers were assessed during both pre-intervention no stress (“at rest”) and before the final exam (“under stress”) periods. To evaluate momentary state anxiety levels, the State-Trait Anxiety Inventory (STAI) questionnaire was employed, commonly used as an indicator of distress in stressful conditions research [@Wauters-probioticbacteria]. Cortisol, a steroid hormone present in the blood, urine, and saliva, served as a prevalent physiological stress marker [@Iqbal-cortisolmarker]. Salivary cortisol levels were measured by collecting non-invasive saliva samples at home.

## Data Analysis

The dataset provided by @Karbownik-datasetstudy was filtered to exhibit select variables in the format of a long table. 

``` {r print-dataset}
probiotics.stress.data
```

## Hypothesis
**Null Hypothesis:** There is no difference between placebo and *S. boulardii* supplementation on academic performance and stress marker levels in healthy medical students.

**Alternative Hypothesis:** Supplementation with *S.boulardii* will improve academic performance and decrease stress marker levels in healthy medical students.

## Note - The *S.boulardii* (Probiotic) group will be referred to as "probiotic" in some sections of the paper.

# Results

``` {r table1-mean-summary, fig.cap="Summary of Mean Academic Performance and Stress Variable Changes At Rest or Under Stress with Placebo or S. boulardii (Probiotic) Administration.", fig.pos='H', out.width="\\textwidth"}
# Create dataset to convert into a table
table_columns <- probiotics.stress.data[, c("participant code", "group", "anxiety at rest", "anxiety under stress", "pre-exam score", "final exam score", "cortisol at rest", "cortisol under stress", "pulse rate at rest", "pulse rate under stress")]

summary_table <- table_columns %>%
  group_by(group) %>% # Was unable to bold the "group" column, will need to modify the dataset
  summarize("Mean Anxiety At Rest" = mean(`anxiety at rest`),
            "Mean Anxiety Under Stress" = mean(`anxiety under stress`),
            "Mean Pre-Exam Score" = mean(`pre-exam score`),
            "Mean Final Exam Score" = mean(`final exam score`),
            "Mean Cortisol At Rest" = mean(`cortisol at rest`),
            "Mean Coritsol Under Stress" = mean(`cortisol under stress`),
            "Mean Pulse Rate At Rest" = mean(`pulse rate at rest`),
            "Mean Pulse Rate Under Stress" = mean(`pulse rate under stress`)) %>%
  pivot_longer(cols = -group, names_to = "Variable", values_to = "Mean") %>%
  pivot_wider(names_from = group, values_from = Mean) %>%
  mutate(across(-Variable, ~round(., 1)))

colnames(summary_table) <- c("Variable", "Placebo", "S. boulardii (Probiotic)")

summary_table %>%
  kbl(caption = "At Rest and Under Stress Mean Values for Academic Performance and Stress Markers with Placebo or Probiotic Supplementation", align = "c") %>%
  kable_styling(full_width = FALSE, font_size = 14, latex_options = c("scale_down")) %>% 
  kable_classic(full_width = F, html_font = "Times New Roman") %>%
  row_spec(0, bold = TRUE) %>%
  column_spec(column = 1:3, border_left = TRUE, border_right = TRUE)
```

Table\ \@ref(tab:table1-mean-summary) displays the summary mean values of academic performance and stress marker changes for both the placebo and *S. boulardii* (probiotic) groups during "at rest" and "under stress" conditions.

``` {r plot1-pre-and-exam-scores, fig.cap="Pre-Exam and Final Exam Scores with Placebo or S. boulardii (Probiotic) Supplementation for 30 days.", fig.pos='H', out.width="\\textwidth"}

# Creates plot1 long data
plot1_data <- gather(probiotics.stress.data, key = "exam_score_type", value = "score", `final exam score`, `pre-exam score`)

# Selecting the variables required for plot1
plot1_columns <- plot1_data %>%
  arrange(desc(exam_score_type)) %>%
  mutate(`exam_score_type` = replace(`exam_score_type`, `exam_score_type` == "pre-exam score", "Pre-exam Score")) %>%
  mutate(`exam_score_type` = replace(`exam_score_type`, `exam_score_type` == "final exam score", "Final Exam Score")) %>%
  mutate(`group` = replace(`group`, `group` == "placebo", "Placebo")) %>%
  mutate(`group` = replace(`group`, `group` == "S. boulardii (probiotic)", "S. boulardii (Probiotic)")) %>%
  select(`participant code`, `group`, `exam_score_type`, `score`)

# Re-order the exams so that pre-examination score is on the left side of the plot, and final exam score is on the right side
exam_order <- c("Pre-exam Score", "Final Exam Score")

# Making a boxplot displaying the pre-examination and exam scores for the two different groups (placebo or probiotic)
plot1_columns %>%
  ggplot(aes(x = `group`, y = `score`,  
             fill = `group`)) + 
  geom_boxplot() +
  scale_fill_manual(values = c("Placebo" = "#ffdbff", "S. boulardii (Probiotic)" = "#afffff")) +
  scale_color_manual(values = c("Placebo" = "#b81376", "S. boulardii (Probiotic)" = "#0083a6")) +
  facet_wrap((~factor(exam_score_type, levels = exam_order)), ncol = 2) +
  geom_point(aes(color = `group`), alpha = 0.8, position = position_jitterdodge()) + # Make sure jitter data points are associated with their respective groups - pre-exam and exam
  labs(title = "Pre-exam and Final Exam Scores for the Placebo and S. boulardii (Probiotic) Groups",
       x = "",
       y = "Score",
       color = "Group",
       fill = "Group") +
  theme_bw() +
  theme(
    plot.title = element_text(face = "bold", size = 12),
    plot.subtitle = element_text(size = 10),
    axis.title = element_text(size = 10),
    axis.text.x = element_blank(),
    legend.background = element_rect(color = "black", fill = "white"),
    legend.position = "bottom",
    legend.text = element_text(size = 9),
    legend.title = element_text(face = "bold", size = 10),
    strip.background = element_rect(fill = "white"),
    strip.text = element_text(face = "bold", size = 8, color = "black"),
    panel.border = element_rect(color = "black", fill = NA),
    legend.key = element_rect(fill = 'white'))
```

``` {r plot1-statistical-testing}

## Hypothesis Testing Analysis (Pre-exam score difference between Placebo and Probiotic groups)

# Create dataset with selected variables - group, pre-exam scores for placebo and probiotic groups.
plot1_preexam_stats <- plot1_data %>%
  select(`participant code`, `group`, `exam_score_type`, `score`) %>%
  filter(`exam_score_type`== "pre-exam score")
  
# Run t-test
plot1_preexam_ttest <- t.test(
  filter(plot1_preexam_stats, `group` == "Placebo")$`score`,
  filter(plot1_preexam_stats, `group` == "S. boulardii (probiotic)")$`score`
)
# No statistical significance between the placebo and probiotic groups - will be accepting the null hypothesis
# t score falls within confidence interval

# Create dataset with selected variables - group, exam scores for placebo and probiotic groups.
plot1_finalexam_stats <- plot1_data %>%
  select(`participant code`, `group`, `exam_score_type`, `score`) %>%
  filter(`exam_score_type`== "final exam score")
  
# Run t-test
plot1_finalexam_ttest <- t.test(
  filter(plot1_finalexam_stats, `group` == "Placebo")$`score`,
  filter(plot1_finalexam_stats, `group` == "S. boulardii (probiotic)")$`score`
)
# No statistical significance between the placebo and probiotic groups - will be accepting the null hypothesis
# t score falls within confidence interval
```
The pre-examination and final examination scores of participants in the placebo and probiotic groups was displayed in Figure\ \@ref(fig:plot1-pre-and-exam-scores). The pre-exam scores between the placebo and probiotic groups were compared and exhibited a p-value of `r plot1_preexam_ttest$p.value`, indicating no statistical significance. Comparing the final exam scores for both groups also displayed no statistical significance, with a p-value of `r plot1_finalexam_ttest$p.value`. *S. boulardii* supplementation did not significantly enhance final exam scores compared to the placebo group, leading us to accept the null hypothesis.


``` {r plot2-cortisol-and-pulserate, fig.cap="Salivary Cortisol [ng/mL] vs. Pulse Rate [min-1] Changes At Rest and Under Stress with Placebo or S. boulardii (Probiotic) Administration.", fig.pos='H', out.width="\\textwidth"}

plot2_longdata <- probiotics.stress.data %>%
  gather(key = "at rest or under stress", value = "cortisol",
         `cortisol at rest`, `cortisol under stress`) %>%
  gather(key = "at rest or under stress", value = "pulse rate",
         `pulse rate at rest`, `pulse rate under stress`)

plot2_columns <- plot2_longdata %>%
  select('participant code', 'group', 'cortisol', 'at rest or under stress', 'pulse rate') %>%
  mutate(`group` = replace(`group`, `group` == "placebo", "Placebo")) %>%
  mutate(`group` = replace(`group`, `group` == "S. boulardii (probiotic)", "S. boulardii (Probiotic)")) %>%
  mutate(`at rest or under stress` = gsub("pulse rate at rest", "At rest", `at rest or under stress`)) %>%
  mutate(`at rest or under stress` = gsub("pulse rate under stress", "Under stress", `at rest or under stress`)) %>%
  filter(!(cortisol > 15))

strip_colors <-strip_themed(background_x = elem_list_rect(fill = c("#ffdbff", "#afffff")))

plot2_columns %>%
  ggplot(aes(x = `cortisol`, y = `pulse rate`, shape = `at rest or under stress`, color = `at rest or under stress`)) +
  geom_point() +
  scale_color_manual(values=c("#00b816", "#007512")) +
  coord_cartesian(xlim = c(0,15), ylim = c(40,130)) +
  facet_wrap2(~ `group`, scales = "free", strip = strip_colors) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Salivary Cortisol vs. Pulse Rate Changes in Healthy Medical Students",
       subtitle = "At Rest and Under Stress Changes in the Placebo and S. boulardii (Probiotic) Groups",
       x = "Salivary Cortisol [ng/mL]",
       y = "Pulse Rate [min-1]",
       shape = "Condition",
       color = "Condition") +
  theme_bw() +
  theme(
    plot.title = element_text(face = "bold", size = 12),
    plot.subtitle = element_text(size = 10),
    axis.title = element_text(size = 10),
    legend.background = element_rect(color = "black", fill = "white"),
    legend.text = element_text(size = 10),
    legend.title = element_text(size = 12),
    strip.text = element_text(face = "bold", size = 8, color = "black"),
    panel.border = element_rect(color = "black", fill = NA),
    legend.key = element_rect(fill = 'white'),
    axis.text.x = element_text(size = 8),
    axis.text.y = element_text(size = 8))
```

```{r plot2-statistical-testing}

## Placebo at rest
plot2_placebo_data_atrest <- plot2_columns %>%
  filter(group =="Placebo", `at rest or under stress` == "At rest")

plot2_placebo_lm_atrest <- tidy(lm(`pulse rate` ~ `cortisol`, data = plot2_placebo_data_atrest))

#plot2_placebo_lm_atrest$p.value[2]

# p value for slope is 0.13895. No statistically significant evidence between cortisol and pulse rate.

## Placebo under stress
plot2_placebo_data_understress <- plot2_columns %>%
  filter(group =="Placebo", `at rest or under stress` == "Under stress")

plot2_placebo_lm_understress <- tidy(lm(`pulse rate` ~ `cortisol`, data = plot2_placebo_data_understress))

#plot2_placebo_lm_understress$p.value[2]

# p value for slope is 0.1252089. No statistically significant evidence between cortisol and pulse rate.


## Probiotic at rest
plot2_probiotic_data_atrest <- plot2_columns %>%
  filter(group =="S. boulardii (Probiotic)", `at rest or under stress` == "At rest")

plot2_probiotic_lm_atrest <- tidy(lm(`pulse rate` ~ `cortisol`, data = plot2_probiotic_data_atrest))

#plot2_probiotic_lm_atrest$p.value[2]

# p value for slope is 0.9202859. No statistically significant evidence between cortisol and pulse rate.

## Probiotic under stress
plot2_probiotic_data_understress <- plot2_columns %>%
  filter(group =="S. boulardii (Probiotic)", `at rest or under stress` == "Under stress")

plot2_probiotic_lm_understress <- tidy(lm(`pulse rate` ~ `cortisol`, data = plot2_probiotic_data_understress))

#plot2_probiotic_lm_understress$p.value[2]

# p value for slope is 0.7684893. No statistically significant evidence between cortisol and pulse rate.
```

Figure\ \@ref(fig:plot2-cortisol-and-pulserate) examined whether there was a correlation between salivary cortisol levels [ng/mL] and pulse rate [min-1] during "at rest" and "under stress" conditions for both the placebo and *S. boulardii* (probiotic) group. The slope for "at rest" and "under stress" conditions was calculated for each treatment group. The placebo slope values were not statistically significant, with an "at rest" slope value of `r plot2_placebo_lm_atrest$p.value[2]`, and an "under stress" slope value of `r plot2_placebo_lm_understress$p.value[2]`. Similarly the *S. boulardii* (probiotic) group also displayed no statistical significance, with a slope value of `r plot2_probiotic_lm_atrest$p.value[2]` "at rest", and slope value of `r plot2_probiotic_lm_understress$p.value[2]` "under stress." As both groups did not display any statistical significance, there is no strong evidence to show a correlation between salivary cortisol levels and pulse rate changes in this healthy medical student sample.

```{r plot3-anxiety-vs-groups, fig.cap="State Anxeity Changes At Rest and Under Stress with Placebo or S. boulardii (Probiotic) Supplementation.", fig.pos='H', out.width="\\textwidth"}
plot3_data <- probiotics.stress.data %>%
  gather(key = "at rest or under stress", value = "anxiety",
         `anxiety at rest`, `anxiety under stress`) %>%
  select('participant code', 'group', 'anxiety', 'at rest or under stress') %>%
  mutate(`group` = replace(`group`, `group` == "placebo", "Placebo")) %>%
  mutate(`group` = replace(`group`, `group` == "S. boulardii (probiotic)", "S. boulardii (Probiotic)")) %>%
  mutate(`at rest or under stress` = gsub("anxiety at rest", "At Rest", `at rest or under stress`)) %>%
  mutate(`at rest or under stress` = gsub("anxiety under stress", "Under Stress", `at rest or under stress`))

strip_colors <-strip_themed(background_x = elem_list_rect(fill = c("#ffdbff", "#afffff")))

plot3_data %>%
  ggplot(aes(x = `at rest or under stress`, y = `anxiety`, shape = `at rest or under stress`, color = `at rest or under stress`, group = `participant code`)) +
  geom_point() +
  geom_line(linewidth=0.4, colour = "gray") +
  scale_color_manual(values=c("#00b816", "#007512")) +
  facet_wrap2(~ `group`, scales = "free", strip = strip_colors) +
  labs(title = "State Anxiety Levels of Healthy Medical Students",
       subtitle = "At Rest and Under Stress Changes in the Placebo and S. boulardii (Probiotic) Groups",
       x = "",
       y = "Anxiety Level",
       shape = "Condition",
       color = "Condition") +
  theme_bw() +
  theme(
    plot.title = element_text(face = "bold", size = 12),
    plot.subtitle = element_text(size = 10),
    axis.title = element_text(size = 10),
    legend.background = element_rect(color = "black", fill = "white"),
    legend.text = element_text(size = 10),
    legend.title = element_text(size = 12),
    strip.text = element_text(face = "bold", size = 8, color = "black"),
    legend.key = element_rect(fill = 'white'),
    axis.text.x = element_text(size = 8),
    axis.text.y = element_text(size = 8))
```

``` {r plot3-statistical-testing}

## Hypothesis Testing Analysis (Placebo anxiety difference)

# Null hypothesis: There is no difference in anxiety between at rest or under stress.
# Alternative hypothesis: There is a difference in anxiety between at rest or under stress.

# Create dataset with selected variables - group, anxiety at rest and under stress
plot3_stat_data_placebo <- plot3_data %>%
  filter(`group`== "Placebo")
  
# Run t-test
plot3_placebo_ttest <- t.test(
  filter(plot3_stat_data_placebo, `at rest or under stress` == "At Rest")$`anxiety`,
  filter(plot3_stat_data_placebo, `at rest or under stress` == "Under Stress")$`anxiety`
)

# Statistical significance between the at rest and under stress - will be rejecting the null hypothesis
# t score falls outside confidence interval

## Hypothesis Testing Analysis (Probiotic anxiety difference)

# Null hypothesis: There is no difference in anxiety between at rest or under stress.
# Alternative hypothesis: There is a difference in anxiety between at rest or under stress.

# Create dataset with selected variables - group, anxiety at rest and under stress
plot3_stat_data_probiotic <- plot3_data %>%
  filter(`group`== "S. boulardii (Probiotic)")
  
# Run t-test
plot3_probiotic_ttest <- t.test(
  filter(plot3_stat_data_probiotic, `at rest or under stress` == "At Rest")$`anxiety`,
  filter(plot3_stat_data_probiotic, `at rest or under stress` == "Under Stress")$`anxiety`
)

# Statistical significance between the at rest and under stress - will be rejecting the null hypothesis
# t score falls outside confidence interval

## Hypothesis Testing Analysis (Comparing anxiety difference between both groups)

# Null hypothesis: There is no difference in anxiety between both groups.
# Alternative hypothesis: There is a difference in anxiety between both groups.

# Create dataset with selected variables - group, anxiety at rest and under stress
plot3_stat_data_compare <- probiotics.stress.data %>%
  mutate(`anxiety difference` = `anxiety under stress` - `anxiety at rest`) %>%
  select(`participant code`, `group`, `anxiety difference`)
  
# Run t-test
plot3_compare_ttest <- t.test(
  filter(plot3_stat_data_compare, `group` == "Placebo")$`anxiety difference`,
  filter(plot3_stat_data_compare, `group` == "S. boulardii (probiotic)")$`anxiety difference`
)

# No statistical significant difference in anxiety across both groups - will be accepting the null hypothesis
# t score falls within confidence interval
```

The state anxiety levels "at rest" and "under stress" for the placebo and *S. boulardii* (probiotic) group is demonstrated in Figure\ \@ref(fig:plot3-anxiety-vs-groups). Statistical significance in the change in state anxiety levels between "at rest" and "under stress" for the placebo and *S. boulardii* (probiotic) group was first conducted separately. Both groups showed a statistically significant difference where the placebo group had a p-value of `r plot3_placebo_ttest$p.value[5]`, and the *S. boulardii* (probiotic) showed a p-value of `r plot3_probiotic_ttest$p.value[5]`. Furthermore, when investigating the change in difference of state anxiety levels between the two groups, there was no statistically significant result as a p-value of `r plot3_compare_ttest$p.value` is observed. Therefore, the null hypothesis is accepted, as there is no difference in state anxiety levels with *S. boulardii* (probiotic) use.


``` {r plot4-cortisol-vs-groups, fig.cap="Salivary Cortisol Level Changes At Rest and Under Stress with Placebo or S. boulardii (Probiotic) Administration for 30 Days.", fig.pos='H', out.width="\\textwidth"}

plot4_data <- probiotics.stress.data %>%
  gather(key = "at rest or under stress", value = "cortisol",
         `cortisol at rest`, `cortisol under stress`) %>%
  select('participant code', 'group', 'cortisol', 'at rest or under stress') %>%
  mutate(`group` = replace(`group`, `group` == "placebo", "Placebo")) %>%
  mutate(`group` = replace(`group`, `group` == "S. boulardii (probiotic)", "S. boulardii (Probiotic)")) %>%
  mutate(`at rest or under stress` = gsub("cortisol at rest", "At Rest", `at rest or under stress`)) %>%
  mutate(`at rest or under stress` = gsub("cortisol under stress", "Under Stress", `at rest or under stress`))

strip_colors <-strip_themed(background_x = elem_list_rect(fill = c("#ffdbff", "#afffff")))

plot4_data %>%
  filter(!(cortisol > 15)) %>%
  ggplot(aes(x = `at rest or under stress`, y = `cortisol`, shape = `at rest or under stress`, color = `at rest or under stress`, group = `participant code`)) +
  geom_point() +
  geom_line(linewidth=0.4, colour = "gray") +
  scale_color_manual(values=c("#00b816", "#007512")) +
  coord_cartesian(ylim = c(0,15)) +
  facet_wrap2(~ `group`, scales = "free", strip = strip_colors) +
  labs(title = "Salivary Cortisol Levels of Healthy Medical Students",
       subtitle = "At Rest and Under Stress Changes in the Placebo and S. boulardii (Probiotic)Groups",
       x = "",
       y = "Cortisol Levels [ng/mL]",
       shape = "Condition",
       color = "Condition") +
  theme_bw() +
  theme(
    plot.title = element_text(face = "bold", size = 12),
    plot.subtitle = element_text(size = 10),
    axis.title = element_text(size = 10),
    legend.background = element_rect(color = "black", fill = "white"),
    legend.text = element_text(size = 10),
    legend.title = element_text(size = 12),
    strip.text = element_text(face = "bold", size = 8, color = "black"),
    legend.key = element_rect(fill = 'white'),
    axis.text.x = element_text(size = 8),
    axis.text.y = element_text(size = 8))
```

``` {r plot4-statistical-testing}

## Hypothesis Testing Analysis (Placebo cortisol difference)

# Null hypothesis: There is no difference in cortisol between at rest or under stress.
# Alternative hypothesis: There is a difference in cortisol between at rest or under stress.

# Create dataset with selected variables - group, cortisol at rest and under stress
plot4_stat_data_placebo <- plot4_data %>%
  filter(`group`== "Placebo")
  
# Run t-test
plot4_placebo_ttest <- t.test(
  filter(plot4_stat_data_placebo, `at rest or under stress` == "At Rest")$`cortisol`,
  filter(plot4_stat_data_placebo, `at rest or under stress` == "Under Stress")$`cortisol`
)
#plot4_placebo_ttest
# No statistical significance between the at rest and under stress - will be accepting the null hypothesis
# t score falls within confidence interval

## Hypothesis Testing Analysis (Probiotic cortisol difference)

# Null hypothesis: There is no difference in cortisol between at rest or under stress.
# Alternative hypothesis: There is a difference in cortisol between at rest or under stress.

# Create dataset with selected variables - group, cortisol at rest and under stress
plot4_stat_data_probiotic <- plot4_data %>%
  filter(`group`== "S. boulardii (Probiotic)")
  
# Run t-test
plot4_probiotic_ttest <- t.test(
  filter(plot4_stat_data_probiotic, `at rest or under stress` == "At Rest")$`cortisol`,
  filter(plot4_stat_data_probiotic, `at rest or under stress` == "Under Stress")$`cortisol`
)
#plot4_probiotic_ttest
# No statistical significance between the at rest and under stress - will be accepting the null hypothesis
# t score falls within confidence interval

## Hypothesis Testing Analysis (Comparing cortisol difference between both groups)

# Null hypothesis: There is no difference in cortisol between both groups.
# Alternative hypothesis: There is a difference in cortisol between both groups.

# Create dataset with selected variables - group, cortisol at rest and under stress
plot4_stat_data_compare <- probiotics.stress.data %>%
  mutate(`cortisol difference` = `cortisol under stress` - `cortisol at rest`) %>%
  select(`participant code`, `group`, `cortisol difference`)
  
# Run t-test
plot4_compare_ttest <- t.test(
  filter(plot4_stat_data_compare, `group` == "Placebo")$`cortisol difference`,
  filter(plot4_stat_data_compare, `group` == "S. boulardii (probiotic)")$`cortisol difference`
)
#plot4_compare_ttest
# No statistical significant difference in cortisol across both groups - will be accepting the null hypothesis
# t score falls within confidence interval
```

"At rest" and "under stress" changes in salivary cortisol levels [ng/mL] in placebo and *S. boulardii* (probiotic) groups were observed in Figure\ \@ref(fig:plot4-cortisol-vs-groups). While the *S. boulardii* (probiotic) group did not display a statistically significant change between the "at rest" and "under stress" salivary cortisol levels (p-value = `r plot4_probiotic_ttest$p.value`), the placebo group showed a statically significant result (p-value = `r plot4_placebo_ttest$p.value`). Assessing the statistical signficance between groups did not result in a statistically significant difference, p-value = `r plot4_compare_ttest$p.value`. Although the placebo group displayed a statistically significant change in salivary cortisol levels between "at rest" and "under stress" conditions, the null hypothesis is accepted as the *S. boulardii* probiotic group did not affect salivary cortisol levels.

```{r plot5-pulserate-vs-groups, fig.cap="Pulse Rate Changes At Rest and Under Stress with Placebo or S. boulardii (Probiotic) Administration.", fig.pos='H', out.width="100%"}

plot5_data <- probiotics.stress.data %>%
  gather(key = "at rest or under stress", value = "pulse rate",
         `pulse rate at rest`, `pulse rate under stress`) %>%
  select('participant code', 'group', 'pulse rate', 'at rest or under stress') %>%
  mutate(`group` = replace(`group`, `group` == "placebo", "Placebo")) %>%
  mutate(`group` = replace(`group`, `group` == "saccharomyces boulardii (probiotic)", "S. boulardii (Probiotic)")) %>%
  mutate(`at rest or under stress` = gsub("pulse rate at rest", "At Rest", `at rest or under stress`)) %>%
  mutate(`at rest or under stress` = gsub("pulse rate under stress", "Under Stress", `at rest or under stress`))

strip_colors <-strip_themed(background_x = elem_list_rect(fill = c("#ffdbff", "#afffff")))

plot5_data %>%
  ggplot(aes(x = `at rest or under stress`, y = `pulse rate`, shape = `at rest or under stress`, color = `at rest or under stress`, group = `participant code`)) +
  geom_point() +
  geom_line(linewidth=0.4, colour = "gray") +
  scale_color_manual(values=c("#00b816", "#007512")) +
  #coord_cartesian(ylim = c(45,135)) +
  facet_wrap2(~ `group`, scales = "free", strip = strip_colors) +
  labs(title = "Pulse Rate of Healthy Medical Students",
       subtitle = "At Rest and Under Stress Changes in the Placebo and S. boulardii (Probiotic) Groups",
       x = "",
       y = "Pulse Rate [min-1]",
       shape = "Condition",
       color = "Condition") +
  theme_bw() +
  theme(
    plot.title = element_text(face = "bold", size = 12),
    plot.subtitle = element_text(size = 10),
    axis.title = element_text(size = 10),
    legend.background = element_rect(color = "black", fill = "white"),
    legend.text = element_text(size = 10),
    legend.title = element_text(size = 12),
    strip.text = element_text(face = "bold", size = 8, color = "black"),
    legend.key = element_rect(fill = 'white'),
    axis.text.x = element_text(size = 8),
    axis.text.y = element_text(size = 8))
```

``` {r plot5-statistical-testing}

## Hypothesis Testing Analysis (Placebo pulse rate difference)

# Null hypothesis: There is no difference in pulse rate between at rest or under stress.
# Alternative hypothesis: There is a difference in pulse rate between at rest or under stress.

# Create dataset with selected variables - group, pulse rates at rest and under stress
plot5_stat_data_placebo <- plot5_data %>%
  select(`participant code`, `group`, `at rest or under stress`, `pulse rate`) %>%
  filter(`group`== "Placebo")
  
# Run t-test
plot5_placebo_ttest <- t.test(
  filter(plot5_stat_data_placebo, `at rest or under stress` == "At Rest")$`pulse rate`,
  filter(plot5_stat_data_placebo, `at rest or under stress` == "Under Stress")$`pulse rate`
)
plot5_placebo_ttest
# Statistical significance between the at rest and under stress - will be rejecting the null hypothesis
# t score falls outside confidence interval

## Hypothesis Testing Analysis (Probiotic pulse rate difference)

# Null hypothesis: There is no difference in pulse rate between at rest or under stress.
# Alternative hypothesis: There is a difference in pulse rate between at rest or under stress.

# Create dataset with selected variables - group, pulse rates at rest and under stress
plot5_stat_data_probiotic <- plot5_data %>%
  select(`participant code`, `group`, `at rest or under stress`, `pulse rate`) %>%
  filter(`group`== "S. boulardii (probiotic)")
  
# Run t-test
plot5_probiotic_ttest <- t.test(
  filter(plot5_stat_data_probiotic, `at rest or under stress` == "At Rest")$`pulse rate`,
  filter(plot5_stat_data_probiotic, `at rest or under stress` == "Under Stress")$`pulse rate`
)
plot5_probiotic_ttest
# Statistical significance between the at rest and under stress - will be rejecting the null hypothesis
# t score falls outside confidence interval

## Hypothesis Testing Analysis (Comparing pulse rate difference between both groups)

# Null hypothesis: There is no difference in pulse rate between both groups.
# Alternative hypothesis: There is a difference in pulse rate between both groups.

# Create dataset with selected variables - group, pulse rates at rest and under stress
plot5_stat_data_compare <- probiotics.stress.data %>%
  mutate(`pulse rate difference` = `pulse rate under stress` - `pulse rate at rest`) %>%
  select(`participant code`, `group`, `pulse rate difference`)
  
# Run t-test
plot5_compare_ttest <- t.test(
  filter(plot5_stat_data_compare, `group` == "Placebo")$`pulse rate difference`,
  filter(plot5_stat_data_compare, `group` == "S. boulardii (probiotic)")$`pulse rate difference`
)
plot5_compare_ttest
# Statistical significant difference in pulse rate difference across both groups - will be rejecting the null hypothesis
# t score falls outside confidence interval
```

Pulse rate [min-1] changes "at rest" and "under stress" in the placebo and *S. boulardii* (probiotic) groups were illustrated in Figure\ \@ref(fig:plot5-pulserate-vs-groups). The placebo group displayed a p-value of `r plot5_placebo_ttest$p.value[4]`, indicating a statistically significant change between "at rest" and "under stress" pulse rate levels. A statistically significant p-value of `r plot5_probiotic_ttest$p.value[9]` was observed in the *S. boulardii* (probiotic) group. When comparing the placebo and *S. boulardii* (probiotic) groups, a statistically significant result (p-value = `r plot5_compare_ttest$p.value[4]`) in pulse rate changes can allow the null hypothesis to be rejected.

## Discussion
Bacterial and yeast probiotics have unique biological properties, making it difficult to generalize the results obtained from bacterial probiotics to yeast probiotics [@Goplan-probioticproperties; @Pais-probioticinfo]. Saccharomyces boulardii is a yeast probiotic treatment used for gastrointestinal disorders [@Roysarkar-yeastprobioticeffect], and its effects on stress, cognition, academic performance, anxiety and depression are yet to be determined. *S. boulardii* is from the same genus as *Saccharomyces cerevisiae*, otherwise known as baker’s yeast [@Pais-probioticinfo]. This paper aimed to analyze the dataset provided by the study conducted by @Karbownik-datasetstudy examining the effects of *S. boulardii* supplementation on academic performance and stress markers in healthy medical students.

\newpage
# References 

::: {#refs custom-style="Bibliography"}
:::
